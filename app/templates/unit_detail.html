
{% extends 'base.html' %}
{% block content %}
<h1>Unit {{ unit.serial }}</h1>

<table>
  <thead>
    <tr><th>Step</th><th>Status</th><th>Updated</th><th>Station</th><th>Operator</th><th>Notes</th><th>Actions</th></tr>
  </thead>
  <tbody>
    {% for s in steps %}
      {% set us = ustates.get(s.id) %}
      <tr>
        <td>{{ s.name }}</td>
        <td>{{ (us.status if us else 'pending')|capitalize }}</td>
        <td>{{ (us.updated_at|dt) if us else '' }}</td>
        <td>{{ us.station if us else '' }}</td>
        <td>{{ us.operator if us else '' }}</td>
        <td>{{ us.notes if us else '' }}</td>
        <td>
          <form method="post" action="{{ url_for('main.unit_detail', serial=unit.serial) }}">
            <input type="hidden" name="step_id" value="{{ s.id }}"/>
            <input type="text" name="operator" placeholder="Initials" size="6" value="{{ request.cookies.get('operator', '') }}"/>
            <input type="text" name="notes" placeholder="Notes" size="12"/>
            <button name="status" value="pass" class="ok">Pass</button>
            <button name="status" value="fail" class="bad">Fail</button>
            <button name="status" value="pending">Reset</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
